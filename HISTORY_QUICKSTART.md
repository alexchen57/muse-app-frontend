# 历史数据视图 - 快速入门指南

## 🚀 开始使用

### 1. 启动应用

```bash
npm run dev
```

应用将在浏览器中打开（通常是 http://localhost:5173）

### 2. 生成测试数据

由于历史数据视图需要历史数据才能显示内容，您需要先生成一些测试数据。

打开浏览器开发者工具（按 F12 或右键 -> 检查），在控制台（Console）中运行以下命令之一：

#### 生成今天的数据（推荐首次使用）
```javascript
window.seedHistoryData.seedTodayData()
```
这将生成从今天早上9点到下午6点的模拟数据（约32,400个数据点）

#### 生成最近7天的数据
```javascript
window.seedHistoryData.seedWeekData()
```
这将生成过去7天的数据（每天约6,480个数据点）

#### 生成最近30天的数据
```javascript
window.seedHistoryData.seedMonthData()
```
这将生成过去30天的数据（数据点较少，适合长期趋势分析）

#### 清除所有历史数据
```javascript
window.seedHistoryData.clearHistoryData()
```

### 3. 查看历史数据

1. 在应用左侧边栏点击 **"📊 History"**
2. 默认显示"今天"的数据
3. 您可以选择不同的时间范围：
   - 今天
   - 最近7天
   - 最近30天
   - 自定义（选择任意时间段）

## 📊 界面说明

### 数据摘要区域
显示选定时间范围内的关键统计信息：
- **心率**: 平均值、最大值、最小值
- **心智负荷**: 平均值、最大值、最小值
- **数据点**: 总记录数
- **总时长**: 监测总时间

### 状态分布区域
以进度条形式显示四种状态的时间分布：
- 🔴 **压力状态（Stressed）**: 高心率 + 高负荷
- 🟢 **平静状态（Calm）**: 低心率 + 低负荷
- 🔵 **高效状态（Productive）**: 适中心率 + 中等负荷
- 🟡 **分心状态（Distracted）**: 波动心率 + 中低负荷

### 历史趋势图表
- **心率历史趋势**: 红色曲线显示心率变化
- **心智负荷历史趋势**: 紫色曲线显示 MWL 变化

### 状态历史时间线
详细列出每个状态的：
- 开始时间
- 状态类型（带颜色标签）
- 持续时长
- 置信度

## 💡 使用技巧

### 数据分析建议

1. **查看日常模式**
   - 选择"今天"查看当日状态
   - 观察哪个时间段最高效
   - 识别压力高峰时段

2. **周趋势分析**
   - 选择"最近7天"
   - 比较不同日期的状态分布
   - 发现工作规律

3. **长期健康监测**
   - 选择"最近30天"
   - 查看长期压力水平
   - 评估工作生活平衡

### 自定义时间范围

点击"自定义"按钮后：
1. 选择开始日期和时间
2. 选择结束日期和时间
3. 系统会自动加载该时段的数据

例如，查看昨天下午2点到4点的数据：
- 开始日期: 昨天 14:00
- 结束日期: 昨天 16:00

## 🔧 开发者工具

### 在代码中使用

如果您想在应用代码中生成数据，可以导入相关函数：

```typescript
import { 
  seedTodayData, 
  seedWeekData, 
  clearHistoryData 
} from './utils/seedHistoryData';

// 在某个按钮点击事件中
async function handleGenerateData() {
  await seedTodayData();
  alert('数据生成完成！');
}
```

### 数据库检查

在浏览器开发者工具中：
1. 打开 **Application** 标签
2. 展开 **IndexedDB**
3. 找到 **MuseDB** 数据库
4. 查看以下表：
   - `heartRate`: 心率数据
   - `mwl`: MWL 数据
   - `stateHistory`: 状态历史

## 🐛 常见问题

### Q: 为什么看不到数据？
A: 确保已经运行了数据生成命令。首次使用时，数据库是空的。

### Q: 数据生成需要多长时间？
A: 
- 今天的数据：约 3-5 秒
- 7天的数据：约 20-30 秒
- 30天的数据：约 60-90 秒

### Q: 图表显示不正常？
A: 尝试以下步骤：
1. 刷新页面
2. 清除浏览器缓存
3. 重新生成数据

### Q: 如何删除旧数据？
A: 运行 `window.seedHistoryData.clearHistoryData()`

### Q: 数据占用多少存储空间？
A: 
- 今天的数据：约 5-10 MB
- 7天的数据：约 30-50 MB
- 30天的数据：约 80-120 MB

## 🎯 下一步

1. **探索实时监测**
   - 返回主页（Home）
   - 查看实时心率和 MWL 数据
   - 观察状态实时分类

2. **音乐推荐功能**
   - 访问音乐库（Music Library）
   - 上传自己的音乐文件
   - 让系统根据您的状态推荐音乐

3. **自定义设置**
   - 访问设置页面（Settings）
   - 调整监测参数
   - 配置个人偏好

## 📚 相关文档

- [完整功能说明](./HISTORY_VIEW_README.md)
- [项目架构文档](./ARCHITECTURE.md)
- [产品需求文档](./PRD_Multi-sensory_Emotional_Regulation_System.md)

## 💬 反馈与支持

如果您在使用过程中遇到任何问题或有改进建议，欢迎：
- 查看控制台日志以获取详细错误信息
- 检查浏览器兼容性（推荐使用 Chrome、Edge 或 Firefox）
- 提交问题报告或功能请求

---

**祝您使用愉快！** 🎉
